{
    "$id": "https://github.com/torus-online/schemas/raw/main/rbac/role.json",
    "$schema": "http://json-schema.org/schema#",
    "title": "Role",
    "type": "object",
    "required": [ "id", "name" ],
    "properties": {
        "id": {
            "type": "string",
            "description": "A UUID that identifies the role",
            "format": "uuid"
        },
        "name": {
            "type": "string",
            "description": "The name of the role"
        },
        "parent": {
            "type": "string",
            "description": "When set, identifies the parent role"
        },
        "subjects": {
            "type": "array",
            "description": "The role's members",
            "items": { "type": "string", "description": "The address of the role member" }
        },
        "permissions": {
            "type": "array",
            "description": "The role's members",
            "items": { "$ref": "#/definitions/permission" }
        }
    },
    "definitions": {
        "permission": {
            "type": "object",
            "required": [ "mode", "action", "object" ],
            "properties": {
                "mode": {
                    "type": "string",
                    "description": "GRANT, DENY, or REVOKE",
                    "pattern": "^GRANT|DENY|REVOKE$"
                },
                "action": {
                    "type": "string",
                    "description": "READ or WRITE",
                    "pattern": "^READ|WRITE|$"
                },
                "object": {
                    "type": "string",
                    "description": "The object that the permission applies to"
                }
            }
        }
    },
    "examples": [
        {
            "$schema": "https://github.com/torus-online/schemas/raw/main/rbac/role.json",
            "id": "179a9b65-48bb-482e-8cfb-c53d266f85a3",
            "name": "administrator",
            "subjects": [ "9a64226fd749513ad0ed2e43e663f7132c92faa7" ],
            "permissions": [
                { "mode": "GRANT", "action": "WRITE", "object": "server://users" }
            ]
        }
    ]
}